<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Summary Settings</title>
  <link rel="stylesheet" href="settings.css">
</head>
<body>
  <div class="settings-container">
    <header>
      <h1>Settings</h1>
      <p class="subtitle">Customize how Claude analyzes your content</p>
      <div class="header-actions">
        <button id="save-btn" class="primary-btn">Save Settings</button>
        <span id="save-status" class="save-status"></span>
      </div>
    </header>

    <div class="settings-content">
      <!-- Output Templates -->
      <section class="setting-section">
        <div class="section-header">
          <h2>Output Templates</h2>
          <button id="reset-template-btn" class="text-btn">Reset to Default</button>
        </div>
        <p class="section-description">
          Customize analysis instructions and output sections per content type. Each content type can have its own prompt and enabled sections.
        </p>

        <div class="template-selector">
          <label for="template-type-select">Content Type:</label>
          <select id="template-type-select">
            <option value="youtube_video">YouTube Video</option>
            <option value="article">Article</option>
            <option value="webpage">Web Page</option>
            <option value="selected_text">Selected Text</option>
            <option value="video_with_captions">Video with Captions</option>
          </select>
        </div>

        <div class="template-editor">
          <h3>Analysis Instructions</h3>
          <textarea id="prompt-template" rows="8" placeholder="Enter your custom instructions..."></textarea>
        </div>

        <div class="template-sections">
          <h3>Output Sections</h3>
          <p class="section-description" style="margin-bottom: 12px;">Toggle which sections to include in the output. Drag to reorder.</p>
          <div id="template-sections-list" class="sections-list">
            <!-- Populated by JS -->
          </div>
        </div>

        <div class="template-presets">
          <h3>Presets</h3>
          <div id="template-presets-list" class="example-list">
            <!-- Populated by JS based on content type -->
          </div>
        </div>
      </section>

      <!-- Action Items Settings -->
      <section class="setting-section">
        <h2>Action Items / Reminders</h2>
        <p class="section-description">
          Configure how action items are displayed and saved to Apple Reminders.
        </p>
        <div class="checkbox-setting">
          <label>
            <input type="checkbox" id="reminders-checked-default" checked>
            <span>Select action items by default</span>
          </label>
          <p class="setting-hint">When unchecked, action items will be unchecked by default and won't be saved to Reminders unless you manually select them.</p>
        </div>
      </section>

      <!-- Claude API Settings -->
      <section class="setting-section">
        <h2>Claude API</h2>
        <p class="section-description">
          Configure how the extension connects to Claude. By default, it uses OAuth credentials from Claude Code. You can also provide an API key as a fallback.
        </p>

        <div class="form-group">
          <label>Auth Status</label>
          <div class="auth-status" id="auth-status">
            <span class="auth-status-dot" id="auth-status-dot"></span>
            <span id="auth-status-text">Checking...</span>
          </div>
        </div>

        <div class="form-group">
          <label for="anthropic-api-key">Anthropic API Key</label>
          <div class="password-input-container">
            <input type="password" id="anthropic-api-key" placeholder="sk-ant-...">
            <button type="button" id="toggle-anthropic-key" class="toggle-visibility-btn" title="Show/hide API key">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </button>
          </div>
          <p class="setting-hint">Only needed if OAuth from Claude Code is not available. Get a key from <a href="https://console.anthropic.com/settings/keys" target="_blank">console.anthropic.com</a></p>
        </div>

        <div class="form-group">
          <label for="claude-model">Model</label>
          <select id="claude-model">
            <option value="sonnet">Claude Sonnet (recommended)</option>
            <option value="opus">Claude Opus</option>
            <option value="haiku">Claude Haiku</option>
          </select>
          <p class="setting-hint">Sonnet offers the best balance of speed and quality. Opus is more capable but slower. Haiku is fastest but less detailed.</p>
        </div>
      </section>

      <!-- Audio Narration Settings -->
      <section class="setting-section">
        <h2>Audio Narration</h2>
        <p class="section-description">
          Generate audio versions of summaries using ElevenLabs Text-to-Speech.
        </p>

        <div class="form-group">
          <label for="elevenlabs-api-key">ElevenLabs API Key</label>
          <div class="password-input-container">
            <input type="password" id="elevenlabs-api-key" placeholder="Enter your API key...">
            <button type="button" id="toggle-api-key" class="toggle-visibility-btn" title="Show/hide API key">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </button>
          </div>
          <p class="setting-hint">Get your API key from <a href="https://elevenlabs.io/app/settings/api-keys" target="_blank">elevenlabs.io</a></p>
        </div>

        <div class="form-group">
          <label for="elevenlabs-voice">Voice</label>
          <select id="elevenlabs-voice" disabled>
            <option value="">Enter API key to load voices</option>
          </select>
          <p class="setting-hint" id="voice-status"></p>
        </div>

        <div class="form-group">
          <label>Audio Content</label>
          <p class="setting-hint" style="margin-bottom: 12px; margin-left: 0;">Select which sections to include in audio narration:</p>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="audio-include-summary" checked>
              <span>Summary</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="audio-include-learnings" checked>
              <span>Key Learnings</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="audio-include-actions">
              <span>Action Items</span>
            </label>
          </div>
        </div>
      </section>

      <!-- Preview -->
      <section class="setting-section">
        <h2>How it works</h2>
        <p class="section-description">
          Your instructions are combined with a system prompt that ensures Claude always outputs in the correct format for the extension to parse.
          The output sections are dynamically built from the enabled sections in your template.
        </p>
        <div class="format-preview">
          <div class="preview-label">Your instructions +</div>
          <div class="preview-box">
            <strong>Output format (auto-generated from template):</strong>
            <pre id="format-preview-content">SUMMARY:
[2-3 paragraph summary]

KEY LEARNINGS:
- [Learning 1]
- [Learning 2]
- ...</pre>
          </div>
        </div>
      </section>
    </div>

  </div>

  <script src="settings.js"></script>
</body>
</html>
